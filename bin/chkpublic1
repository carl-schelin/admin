#!/bin/ksh

# Carl Schelin
# Check the components directory for the spam engine.
#

ADMIN="/usr/local/admin"
SITE1="/data/portals/newmexico/www/components/com_contact"
SITE2="/data/portals/texas/www/components/com_contact"
PUBLIC1="$ADMIN/servers/public1"

ssh public1 "ls -la $SITE1" > $PUBLIC1/newmexico.output
ssh public1 "ls -la $SITE2" > $PUBLIC1/texas.output

if [[ -f $PUBLIC1/newmexico.output ]]
then
  diff $PUBLIC1/newmexico.output $PUBLIC1/newmexico.good > $PUBLIC1/newmexico.diff
  if [[ -s $PUBLIC1/newmexico.diff ]]
  then
    cat $PUBLIC1/newmexico.diff | mailx -s "Public1 Hacked Again" unixadmins@intrado.com
  fi
fi

if [[ -f $PUBLIC1/texas.output ]]
then
  diff $PUBLIC1/texas.output $PUBLIC1/texas.good > $PUBLIC1/texas.diff
  if [[ -s $PUBLIC1/texas.diff ]]
  then
    cat $PUBLIC1/texas.diff | mailx -s "Public1 Hacked Again" unixadmins@intrado.com
  fi
fi

